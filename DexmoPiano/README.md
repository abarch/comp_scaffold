# Learning to play piano

This project teaches a novice to play piano through the use of various practice modes.

If there are any questions/problems feel free to contact Nina.


## Required software/packages
* Python 3.9.5
* python-rtmidi v1.4.1 (via PIP3, needs Debian/Ubuntu package *libjack-dev*)
* LilyPond [v2.18.2](http://lilypond.org/download/binaries/) (available in ubuntu bionic packages)
* python3-tk v3.6.9-1\~18.04 (available in ubuntu bionic packages)
* Qsynth v0.5.0-2 (available in ubuntu bionic packages) - e.g. if the keyboard does not have its own audio output
* vmpk v0.4.0-3 (available in ubuntu bionic packages) - virtual midi keyboard, if no physical one is available
* Debian/Ubuntu package *libasound-dev* might be required (if error "Cannot find alsa/asoundlib.h" occurs)

### requirements.txt
includes required python packages:
* pianoplayer v2.1.0
* MIDIUtil v1.2.1
* mido v1.2.9
* music21 v6.1.0

in order to install the packages run: 
```
$ pip3 install -r requirements.txt
```

## Prerequisites
* Properly connect keyboard/piano (the ports can be checked with the `aconnect` command)
* If used, Qsynth should be running beforehand


## Running the code
Starting the "main" program:
```
$ python3 DexmoPiano/dexmoPianoGui.py
```

## Recording data for HMM Generation
Each task is started, by clicking on *Start Task* and playing the shown piece.
1) Click on *difficulty scaling* to generate iteratively more difficult pieces and 
   play them until the system tells you to practice this piece more.
2) Play the current piece in different practice modes by clicking *Generate New Task* and then 
   the desired practice mode. For optimal learning use the following order:
   * right hand - left hand - single note - slower - identity
3) You can manually increase your complexity level by clicking *Generate New Task* and then *New Complexity Level*

Your error values and played notes are automatically saved as two csv file in folder hmm_data. The name of the generated
file consists of the current date and then either "errors" for the error values or "notes" for the target and actually
played notes. No matter the practice mode or if you closed the GUI in between, all practice opportunities of one day
will be stored in the same file. If you wish to have separate files, for example for different study participants on the
same day, you should rename those files in between sessions.

In the **error file** each row shows the error data of one practice opportunity with the following column values: 
* **Practice Mode**
* **Triple of Task Parameters** Note Picthes, Note values, used hand(s)

And then first for the right hand, then the left hand:
* **pitch error** The number of times, that the wrong key (wrong pitch) was played.
* **note_hold_time error**The sum over all absolute deviations from the correct holding time, meaning the span of time 
  in which the key is pressed down. 
* **timing error** The sum over all absolute deviations from the correct starting time of a note. This represents the 
  cumulative value for notes that were played to early or too late, measured from the start of the previous note.
* **n_missing_notes error** The number of notes that the player forgot or didn't manage to play
* **n_extra_notes error** The number of extra notes, that were falsely played. 
* **summed error value** The sum of all above mentioned error values.

In the **note file** each row represents one practice opportunity and has only one column with a string. That string 
contains the Expected notes and the actual played notes.

## Generating a new piece
New music pieces can be specified by adjusting the settings in the option window (click on *Specify next Task*) and 
generated by clicking on *Generate new Task*.

| Argument | Explanation |
| ---: |  :--- |
| noteValues |  "Lengths" of the notes (e.g. 1, 1/2 etc.) |
| notesPerBar | Amounts of notes that a bar can contain |
| noOfBars |  Number of bars (plus initial empty bar for metronome) |
| bpm | Beats per minute |
| pitches | Note pitches that the piece can contain|
| left | generate notes for left hand |
| right |  generate notes for right hand |
| alternating | generates notes for both hands alternately, instead of simultaneously |

## License
This project is licensed under the GNU General Public License v3.0 - see the [LICENSE](LICENSE) file for details.


## Background
Bachelor Thesis by Nina Ziegenbein (Bielefeld University). Large part of code is based on a previous Masters project.
